# 数据仓库架构基础

## 基本架构

- 在软件行业，一种被普遍接受的架构定义是指系统的一个或多个结构。结构中包括软件的构建(构建是指软件的设计与实现)，构建的外部可以看到属性以及它们之间的相互关系。这里参考此定义，把数据仓库架构理解成构成数据仓库的组件及其之间的关系，那么就有了如图所示的数据仓库架构图。
- ![数仓架构](.\图片\数仓架构.png)

- 操作型系统的数据由各种形式的业务数据组成，这其中可能有关系数据库、TXT或CSV文件、HTML或XML文档，还可能存在外部系统的数据，比如网络爬虫抓取来的互联网数据等，数据可能是结构化、半结构化、非结构化的。这些数据经过抽取、转换和装载(ETL)过程进入数据仓库系统。
- 这里把ETL过程分成了抽取和转换装载两个部分。抽取过程负责从操作型系统获取据。该过程一般不做据聚合和汇总，但是会按照主题进行集成，物理上是将操作型系统的数据全量或增量复制到数据仓库系统的RDS中。
- RDS(RAW DATA STORES)是原始据存储的意思。将原始数据保存到数据仓库里是个不错的想法。ETL过程的Bug或系统中的其他错误是不可避免的，保留原始数据使得追踪并修改这些错误成为可能。
- TDS(TRANSFORMED DATA STORES)意为转换后的数据存储。这是真正的数据仓库中的数据。大量的用户会在经过转换的数据集上处理他们的日常查询。
- 自动化调度组件的作用是自动定期重复执行ETL过程。
- 数据目录有时也被称为元数据存储，它可以提供一份数据仓库中数据的清单。用户通过它应该可以快速解决这些问题，什么类型的数据被存储在哪里，数据集的构建有何区别，数据最后的访问或更新时间等。此外还可以通过数据目录感知数据是如何被操作和转换的。一个好的数据目录是让用户体验到系统易用性的关键。
- 查询引擎组件责实际执行用户查询。
- 用户界面指的是最终用户所使用的接口程序。可能是一个GUI软件，如BI套件中的客户端软件，也可能就是一个浏览器。

## 主要数据仓库架构

### 数据集市架构

- 数据集市是按主题域组织的数据集合，用于支持部门级的决策。

#### 独立数据集市

- **独立数据集市**集中于部门所关心的单一主题域，数据以部门为基础部署，无须考虑企业级别的信息共享与集成。

#### 从属数据集市

- 从属数据集市的数据来源于数据仓库。

##### 好处

1. 性能：当数据仓库的查询性能出现问题，可以考虑建立几个从属数据集市，将查询从数据仓库移出到数据集市。
2. 安全：每个部门可以完全控制他们自己的数据。
3. 数据一致：因为每个数据集市的数据来源都是同一个数据仓库，有效消除了数据不一致的情况。

## `Inmon`企业信息工厂架构

![Inmon架构](.\图片\Inmon架构.png)

- 应用系统，这些应用是组织中的操作型系统，用来支撑业务。
- ETL过程，ETL过程从操作型系统抽取据，然后将数据转换成一种标准形式，最终将转换后的数据装载到企业级数据仓库中。ETL是周期性运行的批处理过程。
- 企业级数据仓库，是该架构中的核心组件。正如Inmon数据仓库所定义的，企业级数据仓库是一个细节数据的集成资源库。其中的数据以最低粒度级别被捕获，存储在满足三范式设计的关系数据库中。
- 部门级数据集市，是面向主题数据的部门级视图。数据从企业级数据仓库取。数据在进入部门数据集市时可能进行聚合。数据集市使用多维模型设计，用于数据分析。重要的一点是，所有的报表工具、BI工具或其他数据分析应用都从数据集市查询数据，而不是直接查询企业级数据仓库。

## `Kimball`数据仓库架构

- `Kimball`数据仓库架构如图所示：
- ![Kimball架构](.\图片\Kimball架构.png)

- `Kimball`与`lnmon`两种架构的主要区别在于核心数据仓库的设计和建立。`Kimball`的数据仓库包含高粒度的企业数据，使用多维模型设计，这也意味着数据仓库由星型模式的维度表和事实表构成。分析系统或报表工具可以直接访问多维数据仓库里的数据。

## 混合型数据仓库架构

- 混合型数据仓库架构如图所示：
- ![混合型架构](.\图片\混合型架构.png)

- 所谓的混合型结构，指的是在一个数据仓库环境中，联合使用Inmon和Kimball两种架构。从架构图可以看到，这种架构将Inmon方法中的数据集市部分替换成了一个多维数据仓库，而数据集市则是多维数据仓库上的逻辑视图。使用这种架构的好处是，既可以利用规范化设计消除数据冗余，保证数据的粒度足够细;又可以利用多维结构更灵活地在企业级实现报表和分析。
